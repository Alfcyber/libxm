FIND_PACKAGE(PkgConfig)

FIND_PACKAGE(OpenGL)

IF(${PKG_CONFIG_FOUND})
PKG_SEARCH_MODULE(GLFW glfw3)
PKG_SEARCH_MODULE(JACK jack)
IF(${GLFW_FOUND} AND ${JACK_FOUND} AND ${OPENGL_FOUND})

ADD_CUSTOM_COMMAND(OUTPUT vs.h COMMAND filetoh vs ${CMAKE_CURRENT_SOURCE_DIR}/vs.c vs.h DEPENDS filetoh vs.c)
ADD_CUSTOM_COMMAND(OUTPUT fs.h COMMAND filetoh fs ${CMAKE_CURRENT_SOURCE_DIR}/fs.c fs.h DEPENDS filetoh fs.c)

ADD_EXECUTABLE(xmgl xmgl.c vs.h fs.h)
INCLUDE_DIRECTORIES(${CMAKE_CURRENT_BINARY_DIR} ${GLFW_INCLUDE_DIRS} ${JACK_INCLUDE_DIRS} ${OPENGL_INCLUDE_DIR})
TARGET_LINK_LIBRARIES(xmgl ${JACK_LIBRARIES} ${XM_LIBRARIES} xms ${OPENGL_gl_LIBRARY} ${GLFW_LIBRARIES})

ENDIF()
ENDIF()
